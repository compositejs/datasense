// datasense
var DataSense,__extends=this&&this.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};!function(_){var e;(e=_.Access||(_.Access={})).setPromise=function(t,e,n,r){return void 0===e?Promise.reject("value is undefined"):"function"!=typeof e.then?n?(t(e),Promise.resolve(e)):Promise.reject("value is not a Promise object"):e.then(function(e){return t(e,r),e})},e.setSubscribe=function(r,e,o,i,s){var a="function"==typeof i;return e.subscribe(function(e){var t=r(e,o);if(a){var n="string"==typeof o?{message:o}:o||{};i.call(s,t,n)}})},e.propsAccessor=function(){function d(e){return r.hasOwnProperty(e)&&r[e].hasOwnProperty("value")}function v(e,t){if(e&&"string"==typeof e){var n=r[e];return n||(n={handlers:[],store:{},flows:[],factory:{}},t&&(r[e]=n)),n}}function i(e,t,n,r,o){var i=v(e,!0);if(!i)return o?new _.ChangedInfo(null,"invalid",!1,void 0,void 0,t,"key is not valid"):void 0;if(r&&i.hasOwnProperty("value"))return o?_.ChangedInfo.fail(e,i.value,t,"ignore"):void 0;if(i.updating){if(!i.updating.custom&&i.updating.value===t)return o?_.ChangedInfo.fail(e,i.value,t,"duplicated"):void 0;i.updating.cancel("duplicated")}var s=new _.OnceController,a=i.updating={value:t,cancel:function(e){s.reject(e)}},c=d(e),u=i.value;b.fire("ing-"+e,new _.ChangingInfo(e,u,t,s.createObservable())),b.fire("prop-changing",new _.ChangingInfo(e,u,t,s.createObservable()));var p=i.flows.map(function(e){if("function"==typeof e)return e(t,n)}),f=t;if("function"==typeof y&&(t=y(e,t)),"function"==typeof g&&!g(e,t)){if(a!==i.updating)return s.reject("expired"),o?_.ChangedInfo.fail(e,i.value,t,"expired"):void 0;var l=_.ChangedInfo.fail(e,u,t,"invalid");return s.reject("invalid"),b.fire("err-"+e,l),b.fire("prop-failed",l),p.forEach(function(e){e&&"function"==typeof e.reject&&e.reject("invalid")}),l}if(a!==i.updating)return s.reject("expired"),o?_.ChangedInfo.fail(e,i.value,t,"expired"):void 0;if(i.updating=null,i.value=t,s.resolve(t),u===t)return _.ChangedInfo.success(e,t,u,c?null:"add",f);var h=_.ChangedInfo.success(e,t,u,c?null:"add",f);return b.fire("ed-"+e,h),b.fire("prop-changed",h),p.forEach(function(e){e&&"function"==typeof e.resolve&&e.resolve(t)}),h}function s(e,a){if(!e)return[];if("string"==typeof e&&(e=[e]),!(e instanceof Array))return[];var c=[];return e.forEach(function(e){var t=v(e,!1);if(t&&d(e)){var n=t.value,r=new _.OnceController,o=t.updating={value:void 0,cancel:function(e){r.reject(e)}};b.fire("ing-"+e,new _.ChangingInfo(e,n,void 0,r.createObservable())),b.fire("prop-changing",new _.ChangingInfo(e,n,void 0,r.createObservable()));var i=t.flows.map(function(e){if("function"==typeof e)return e(void 0,a)});if(o!==t.updating)return r.reject("expired"),_.ChangedInfo.fail(e,t.value,void 0,"expired");t.updating=null,delete t.value;var s=_.ChangedInfo.success(e,void 0,n);c.push(s),r.resolve(void 0),void 0!==n&&(b.fire("ed-"+e,s),b.fire("prop-changed",s),i.forEach(function(e){e&&"function"==typeof e.resolve&&("function"==typeof e.remove?e.remove():e.resolve(void 0))}))}}),c}var y,g,r={},b=new _.EventController,o={},a={hasProp:function(e){return d(e)},getProp:function(e){var t=v(e,!1);return t?t.value:void 0},setProp:function(e,t,n){var r=i(e,t,n,!1,!0);return r&&b.fire("batch-changed",{changed:r},n),r},customizedSetProp:function(n,r,t){var o,i=v(n,!0);if(!i)return{isAborted:!0,resolve:function(e){},reject:function(e){}};if(i.updating){if(i.updating.value===r)return{isAborted:!0,resolve:function(e){},reject:function(e){}};i.updating.cancel("expired")}var s,a=d(n),c=i.value,u=new _.OnceController,p=i.updating={value:r,custom:!0,cancel:function(e){s.isAborted=!0,u.reject(e)}};return b.fire("ing-"+n,new _.ChangingInfo(n,c,r,u.createObservable())),b.fire("prop-changing",new _.ChangingInfo(n,c,r,u.createObservable())),o=i.flows.map(function(e){if("function"==typeof e)return e(r,t)}),s={resolve:function(t){if(p===i.updating){if(0===arguments.length&&(t=r),i.updating=null,u.resolve(t),c===t)return _.ChangedInfo.success(n,t,c,a?null:"add",r);i.value=t;var e=_.ChangedInfo.success(n,t,c,a?null:"add",r);return b.fire("ed-"+n,e),b.fire("prop-changed",e),o.forEach(function(e){e&&"function"==typeof e.resolve&&e.resolve(t)}),e}},reject:function(e){if(p===i.updating){i.updating=null,s.isAborted=!0;var t=_.ChangedInfo.fail(n,c,r,"invalid");u.reject("invalid"),b.fire("err-"+n,t),b.fire("prop-failed",t),o.forEach(function(e){e&&"function"==typeof e.reject&&e.reject("invalid")})}},remove:function(){if(p===i.updating&&(i.updating=null,a)){if(u.resolve(void 0),void 0===c)return _.ChangedInfo.success(n,void 0,c,"remove",r);delete i.value;var e=_.ChangedInfo.success(n,void 0,c,"remove",r);return b.fire("ed-"+n,e),b.fire("prop-changed",e),o.forEach(function(e){e&&"function"==typeof e.resolve&&e.resolve(void 0)}),e}}}},removeProp:function(e,t){var n=s(e,t);return n.length&&b.fire("batch-changed",{changed:n}),n.length},batchProp:function(e,r){if(e){function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];_.ChangedInfo.push.apply(_.ChangedInfo,[n].concat(e))}function t(e){if(e)for(var t in e)if(t&&"string"==typeof t&&e.hasOwnProperty(t)){var n=i(t,e[t],r);o(n)}}var n=[];e instanceof Array?(e.forEach(function(e){if(e&&e.action)switch(e.action){case"delete":o.apply(void 0,s(e.key,r));break;case"batch":t(e.value);break;case"set":o(i(e.key,e.value,r));break;case"init":o(i(e.key,e.value,r,!0))}}),n.length&&b.fire("batch-changed",{changed:n})):t(e)}},forceUpdateProp:function(e,t){var n=v(e,!1);if(n){var r=new _.OnceController;b.fire("ing-"+e,new _.ChangingInfo(e,n.value,n.value,r.createObservable()),t),b.fire("prop-changing",new _.ChangingInfo(e,n.value,n.value,r.createObservable()),t),r.resolve(n.value);var o=_.ChangedInfo.success(e,n.value,n.value);b.fire("ed-"+e,o,t),b.fire("prop-changed",o,t)}},getPropKeys:function(){return Object.keys(r).filter(function(e){return!!r[e]&&r[e].hasOwnProperty("value")})},getFormatter:function(){return y},setFormatter:function(e){y=e},getValidator:function(){return g},setValidator:function(e){g=e},getPropStore:function(e,t){return v(e,!0).store[t]},setPropStore:function(e,t,n){v(e,!0).store[t]=n},removePropStore:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=v(e,!1).store;t.forEach(function(e){delete r.value})},sendPropNotify:function(e,t,n){e&&"string"==typeof e&&b.fire("ntf-"+e,t,n)},sendNotify:function(e,t){b.fire("notify",e,t)},registerPropRequestHandler:function(e,t,n){var r=v(e,!0).factory;if(n){if("function"!=typeof n)return!1;r[t]=n}else delete r[t];return!0},registerRequestHandler:function(e,t){if(t){if("function"!=typeof t)return!1;o[e]=t}else delete o[e];return!0}};return{accessor:a,pushFlows:function(o){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var n=new Date;e=e.filter(function(e){return"function"==typeof e});var r=v(o,!0).flows,i=r.push.apply(r,e);return{get registeredDate(){return n},get count(){return i},sync:function(r){e.forEach(function(e){var t=a.getProp(o),n=e(t,r);n&&"function"==typeof n.resolve&&n.resolve(t)})},dispose:function(){e.forEach(function(e){_.Collection.remove(r,e)})}}},clearFlows:function(e){var t=v(e,!1),n=t.flows.length;return t.flows=[],n},sendPropRequest:function(e,t,n,r){var o=v(e,!1).factory[t];"function"==typeof o&&o(r,n)},sendRequest:function(e,t,n){var r=o[e];"function"==typeof r&&r(n,t)},sendPropBroadcast:function(e,t,n){e&&"string"==typeof e&&b.fire("cst-"+e,t,n)},sendBroadcast:function(e,t){b.fire("broadcast",e,t)},propChanging:b.createMappedObservable("ing-{0}"),propChanged:b.createMappedObservable("ed-{0}"),propChangeFailed:b.createMappedObservable("err-{0}"),propNotifyReceived:b.createMappedObservable("ntf-{0}"),propBroadcastReceived:b.createMappedObservable("cst-{0}"),notifyReceived:b.createSingleObservable("notify"),broadcastReceived:b.createSingleObservable("broadcast"),anyPropChanging:b.createSingleObservable("prop-changing"),anyPropChanged:b.createSingleObservable("prop-changed"),anyPropChangeFailed:b.createSingleObservable("prop-failed"),propsChanged:b.createSingleObservable("batch-changed")}}}(DataSense||(DataSense={})),function(e){var t;function i(e,t,n){if(!e||null==t)return-1;function r(r){var o=-1;return e.some(function(e,t,n){return!!r(e,t,n)&&(o=t,!0)}),o}if(!n)return r(function(e){return e===t});switch(typeof n){case"string":case"number":return r(function(e){return e[n]===t});case"function":return r(function(e){return n(e,t)});default:return-1}}(t=e.Collection||(e.Collection={})).findIndex=i,t.remove=function(e,t,n){for(var r=0;;){var o=i(e,t,n);if(o<0)break;e.splice(o,1),r++}return r}}(DataSense||(DataSense={})),function(o){var e=(t.prototype.push=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=0;return e.forEach(function(e){!e||0<=t._list.indexOf(e)||(t._list.push(e),"function"==typeof e.pushDisposable&&e.pushDisposable({dispose:function(){o.Collection.remove(this._list,e)}}),r++)}),r},t.prototype.pushDisposable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.push.apply(this,e)},t.prototype.remove=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=0;return e.forEach(function(e){e&&o.Collection.remove(t._list,e)<1||r++}),r},t.prototype.removeDisposable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.remove.apply(this,e)},t.prototype.dispose=function(){var e=this._list;this._list=[],t.dispose(e)},t.dispose=function(e){if(e){e instanceof Array||(e=[e]);var n=[];e.forEach(function(t){if(t&&"function"==typeof t.dispose)try{t.dispose()}catch(e){n.push(t)}}),n.forEach(function(e){e&&"function"==typeof e.dispose&&e.dispose()})}},t);function t(){this._list=[]}o.DisposableArray=e}(DataSense||(DataSense={})),function(l){var n=(r.prototype.pushDisposable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._instance).pushDisposable.apply(e,t)},r.prototype.removeDisposable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._instance).removeDisposable.apply(e,t)},r.prototype.on=function(n,e,t,r,o){e||(e=[]),e instanceof Array||(e=[e]);var i=new l.DisposableArray;if(!n||"string"!=typeof n||!e||!e.length){var s=new Date;return{get key(){return n},get count(){return 0},get registerDate(){return s},fire:function(e,t){},pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i.push.apply(i,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i.remove.apply(i,e)},dispose:function(){i.dispose()}}}r||(r={});var a=new l.HitTask;a.setOptions({delay:r.delay,mergeMode:r.mergeMode,span:r.span,minCount:r.minCount,maxCount:r.maxCount}),a.pushHandler(function(t){e.forEach(function(e){"function"==typeof e&&e(t.ev,t.c)})});var c={task:a,arg:r.arg,thisArg:t,invalid:r.invalid,invalidForNextTime:r.invalidForNextTime,time:new Date,store:{},count:0},u=this._instance;u.push(n,c);var p={get key(){return n},get count(){return c.count},get registerDate(){return c.time},fire:function(e,t){u.fire(n,e,t)},pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i.push.apply(i,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i.remove.apply(i,e)},dispose:function(){u.remove(n,c),i.dispose()}};return u.pushDisposable(p),o&&o.pushDisposable(p),p},r.prototype.once=function(e,t,n){return this.on(e,t,n,{invalid:1})},r.prototype.clearOn=function(e){this._instance.remove(e)},r.prototype.createSingleObservable=function(e){return new t(this,e)},r.prototype.subscribeSingle=function(e,t,n,r){var o;if("function"!=typeof t)return(o=function(){}).dispose=function(){},o;var i=this.on(e,function(e){"function"==typeof r&&(e=r(e)),t.call(n,e)});return(o=function(){i.dispose()}).dispose=i.dispose,o},r.prototype.createObservable=function(){return new r(this)},r.prototype.createMappedObservable=function(e){return new r(this,e)},r.prototype.dispose=function(){this._instance.dispose()},r.createFailedOnResult=function(e){var n=new l.DisposableArray;return{get key(){return e},get count(){return 0},get registerDate(){},fire:function(e,t){},pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.push.apply(n,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.remove.apply(n,e)},dispose:function(){n.dispose()}}},r.createNothingSubscribe=function(){function e(){}return e.dispose=function(){},e},r.createForElement=function(e,t){function n(e){r.fire(t,e)}var r=new i;e.addEventListener(t,n);var o=r.createSingleObservable(t);return o.pushDisposable({dispose:function(){e.removeEventListener(t,n)}}),o},r);function r(o,t){function i(e){return t&&e&&"string"==typeof e?"function"==typeof t?t(e):"string"==typeof t?t.replace("{0}",e).replace("{0}",e).replace("{0}",e):e:e}var n=new l.DisposableArray;if(o instanceof r&&o._instance)return this.hasKeyMap=!!t||o.hasKeyMap,this._instance={push:function(e,t){var n=i(e);return n&&n!==e&&(t?t.key=e:t={key:e}),"function"==typeof o._instance.push?o._instance.push(n,t):0},remove:function(e,t){return"function"==typeof o._instance.remove?o._instance.remove(i(e),t):0},fire:function(e,t,n,r){"function"==typeof o._instance.fire&&o._instance.fire(i(e),t,n,r)},pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.pushDisposable.apply(n,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.removeDisposable.apply(n,e)},dispose:function(){n.dispose()}},void o.pushDisposable(this);this.hasKeyMap=!!t;function f(e,t){if(null===e){if(t)return l.Collection.remove(u,t);var n=u.length;return u=[],n}if("string"!=typeof e||!e)return 0;if(t)return l.Collection.remove(c[e],t);if(!c[e])return 0;var r=c[e].length;return c[e]=[],r}function a(e,r,t,n,o,i){if(!r.isInvalid){var s=!1;if(r.invalid&&(!0===r.invalid?s=!0:"number"==typeof r.invalid?r.invalid<=r.count&&(s=!0):"function"==typeof r.invalid&&(s=r.invalid(t))),!s||(r.isInvalid=!0,o.push({key:i?null:e,value:r}),r.invalidForNextTime)){var a=r.latestFireDate,c=r.latestFireDate=new Date;r.count<Number.MAX_SAFE_INTEGER&&r.count++;var u="string"==typeof n?{message:n}:n||{},p=!0;r.task.process({ev:t,c:{get key(){return r.key||e},get originalKey(){return e},get count(){return r.count},get fireDate(){return c},get latestFireDate(){return a},get lastFireDate(){return r.latestFireDate},get registerDate(){return r.time},get arg(){return r.arg},get message(){return u.message},get source(){return u.source},get addition(){return u.addition},hasStoreData:function(e){return r.store.hasOwnProperty(e)},getStoreData:function(e){return r.store[e]},setStoreData:function(e,t){r.store[e]=t},removeStoreData:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=0;return e.forEach(function(e){e&&"string"==typeof e&&(n++,delete r.store[e])}),n},dispose:function(){p?o.push({key:i?null:e,value:r}):f(e,r)}}}),p=!1}}}var c={},u=[];if(this._instance={push:function(e,t){return t?null===e?u.push(t):"string"==typeof e&&e?(c[e]||(c[e]=[]),c[e].push(t)):0:0},remove:function(e,t){return f(e,t)},fire:function(t,n,r,e){if("string"==typeof t&&t&&c[t]){function o(){clearTimeout(s),i.forEach(function(e){f(e.key,e.value)})}var i=[],s=setTimeout(function(){i.forEach(function(e){f(e.key,e.value)})},0);if(e){if(c[t].indexOf(e)<0)return u.indexOf(e)<0?void clearTimeout(s):(a(t,e,n,r,i,!0),void o());a(t,e,n,r,i,!1)}else c[t].forEach(function(e){a(t,e,n,r,i,!1)}),u.forEach(function(e){a(t,e,n,r,i,!0)});o()}},pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.pushDisposable.apply(n,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.removeDisposable.apply(n,e)},dispose:function(){c={},n.dispose()}},"function"==typeof o){var s=this._instance;o(function(e,t,n){s.fire(e,t,n)},function(e,t,n){e||(e=[]),e instanceof Array||(e=[e]),n||(n={});var r=new l.HitTask;r.setOptions({delay:n.delay,mergeMode:n.mergeMode,span:n.span,minCount:n.minCount,maxCount:n.maxCount}),r.pushHandler(function(t){e.forEach(function(e){"function"==typeof e&&e(t.ev,t.c)})});var o={task:r,arg:n.arg,thisArg:t,invalid:n.invalid,invalidForNextTime:n.invalidForNextTime,time:new Date,store:{},count:0};s.push(null,o);var i={get count(){return o.count},get registerDate(){return o.time},fire:function(e,t,n){s.fire(e,t,n)},dispose:function(){s.remove(null,o)}};return s.pushDisposable(i),i})}}l.EventObservable=n;var t=(e.prototype.pushDisposable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._disposable).pushDisposable.apply(e,t)},e.prototype.removeDisposable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._disposable).removeDisposable.apply(e,t)},e.prototype.on=function(e,t,n,r){var o=this._eventObservable.on(this.key,e,t,n,r);return this._disposable.push(o),o},e.prototype.once=function(e,t){var n=this._eventObservable.once(this.key,e,t);return this._disposable.push(n),n},e.prototype.subscribe=function(e,t){var n=this._eventObservable.subscribeSingle(this.key,e,t);return this._disposable.push(n),n},e.prototype.subscribeWithConvertor=function(e,t,n){var r=this._eventObservable.subscribeSingle(this.key,e,t,n);return this._disposable.push(r),r},e.prototype.createObservable=function(){return new e(this._eventObservable,this.key)},e.prototype.dispose=function(){this._disposable.dispose()},e);function e(e,t){this.key=t,this._disposable=new l.DisposableArray,this._eventObservable=e&&e instanceof n?e:new n(null),e.pushDisposable(this)}l.SingleEventObservable=t;var o,i=(__extends(s,o=n),s.prototype.fire=function(e,t,n,r){var o=this;l.HitTask.delay(function(){o._fireHandler(e,t,n)},r)},s.prototype.onAny=function(e,t,n,r){var o=this._onAny(e,t,n);return r&&"function"==typeof r.pushDisposable&&r.pushDisposable(o),o},s.prototype.subscribeAny=function(t,n){var e;if("function"!=typeof t)return(e=function(){}).dispose=function(){},e;var r=this.onAny(function(e){t.call(n,e)});return(e=function(){r.dispose()}).dispose=r.dispose,e},s);function s(){var n,r,e=this;return(e=o.call(this,function(e,t){n=e,r=t})||this)._fireHandler=n,e._onAny=r,e}l.EventController=i;var a=(Object.defineProperty(c.prototype,"isPending",{get:function(){return void 0===this._result.success},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isSuccessful",{get:function(){return!0===this._result.success},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isFailed",{get:function(){return!1===this._result.success},enumerable:!0,configurable:!0}),c.prototype.onResolved=function(e,t,n){!0!==this._result.success?!1!==this._result.success&&(this._result.resolved||(this._result.resolved=[]),this._result.resolved.push({h:e,delay:n,thisArg:t})):e.call(t,this._result.value)},c.prototype.onResolvedLater=function(e,t,n){var r=this;l.HitTask.delay(function(){r.onResolved(e,t,n)},!0)},c.prototype.onRejected=function(e,t,n){!1!==this._result.success?!0!==this._result.success&&(this._result.rejected||(this._result.rejected=[]),this._result.rejected.push({h:e,delay:n,thisArg:t})):e.call(t,this._result.value)},c.prototype.onRejectedLater=function(e,t,n){var r=this;l.HitTask.delay(function(){r.onRejected(e,t,n)},!0)},c.prototype.promise=function(){var n=this;return new Promise(function(e,t){n.onResolved(e),n.onRejected(t)})},c.prototype.then=function(e,t){return this.promise().then(e,t)},c.prototype.catch=function(e){return this.promise().catch(e)},c.prototype.createObservable=function(){return new c(this)},c);function c(e){var r=this;if(this._result={},e instanceof c)this._result=e._result;else if("function"==typeof e){function t(e,t){var n;void 0===r._result.success&&(n=e?(r._result.value=t,r._result.success=!0,r._result.resolved):(r._result.value=t,r._result.success=!1,r._result.rejected),delete r._result.resolved,delete r._result.rejected,n&&n.forEach(function(e){l.HitTask.delay(function(){e.h.call(e.thisArg,t)},e.delay)}))}e(function(e){t(!0,e)},function(e){t(!1,e)})}}l.OnceObservable=a;var u,p=(__extends(f,u=a),f.prototype.resolve=function(e){this._instance.resolve(e)},f.prototype.reject=function(e){this._instance.reject(e)},f);function f(){var n,e=this;return(e=u.call(this,function(e,t){n={resolve:e,reject:t}})||this)._instance=n,e}l.OnceController=p;var h=(d.prototype.onResolved=function(e,t,n){this.observable&&this.observable.onResolved(e,t,n)},d.prototype.onRejected=function(e,t,n){this.observable&&this.observable.onRejected(e,t,n)},d);function d(e,t,n,r,o){this.key=e,this.currentValue=t,this.valueRequest=n,this.observable=r,(this.action=o)||(this.action="update")}l.ChangingInfo=h;var v=(Object.defineProperty(y.prototype,"hasChanged",{get:function(){return this.oldValue===this.value},enumerable:!0,configurable:!0}),y.success=function(e,t,n,r,o,i){return r?!0===r&&(r=t===n?"none":"update"):r=e?t===n?"none":void 0===t?"add":void 0===n?"remove":"update":t===n?"none":"update",new y(e,r,!0,t,n,4<arguments.length?o:t,i)},y.fail=function(e,t,n,r){return new y(e,"none",!1,t,t,n,r)},y.push=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e){var r=-1;t.forEach(function(n){n&&n.key&&(e.some(function(e,t){return e.key===n.key&&(r=t,!0)}),0<=r?e[r]=n:e.push(n))})}},y);function y(e,t,n,r,o,i,s){this.key=e,this.action=t,this.success=n,this.value=r,this.oldValue=o,this.valueRequest=i,this.error=s}l.ChangedInfo=v}(DataSense||(DataSense={})),"function"==typeof define?!define.amd&&"undefined"==typeof __webpack_require__||define(["exports"],function(e){return DataSense}):"function"==typeof require&&"object"==typeof exports&&"object"==typeof module&&(module.exports=DataSense),function(u){var e=(p.prototype.pushDisposable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._instance).pushDisposable.apply(e,t)},p.prototype.removeDisposable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._instance).removeDisposable.apply(e,t)},p.prototype.getKeys=function(){return this._instance.keys()},p.prototype.hasProp=function(e){return this._instance.has(e)},p.prototype.getProp=function(e){return this._instance.get(e)},p.prototype.registerChangeFlow=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return(t=this._instance).pushFlows.apply(t,[e].concat(n))},p.prototype.clearChangeFlow=function(e){return this._instance.clearFlows(e)},p.prototype.onPropChanging=function(e,t,n,r,o){return this.propChanging.on(e,t,n,r,o)},p.prototype.onPropChanged=function(e,t,n,r,o){return this.propChanged.on(e,t,n,r,o)},p.prototype.onPropChangeFailed=function(e,t,n,r,o){return e&&"string"==typeof e?this.propChangeFailed.on(e,t,n,r,o):u.EventObservable.createFailedOnResult(null)},p.prototype.onAnyPropChanging=function(e,t,n,r){return this.anyPropChanging.on(e,t,n,r)},p.prototype.onAnyPropChanged=function(e,t,n,r){return this.anyPropChanged.on(e,t,n,r)},p.prototype.onAnyPropChangeFailed=function(e,t,n,r){return this.anyPropChangeFailed.on(e,t,n,r)},p.prototype.onPropsChanged=function(e,t,n,r){return this.propsChanged.on(e,t,n,r)},p.prototype.onPropBroadcastReceived=function(e,t,n,r,o){return this.propBroadcastReceived.on(e,t,n,r,o)},p.prototype.onBroadcastReceived=function(e,t,n,r){return this.broadcastReceived.on(e,t,n,r)},p.prototype.onPropNotifyReceived=function(e,t,n,r,o){return this.propNotifyReceived.on(e,t,n,r,o)},p.prototype.onNotifyReceived=function(e,t,n,r){return this.notifyReceived.on(e,t,n,r)},p.prototype.subscribeProp=function(e,t,n){return this.propChanged.subscribeSingle(e,t,n,function(e){return e.value})},p.prototype.subscribeProps=function(e,t){return this.propsChanged.subscribeWithConvertor(e,t,function(e){return e.changes})},p.prototype.sendPropRequest=function(e,t,n){this._instance.sendPropRequest(e,t,n)},p.prototype.sendRequest=function(e,t){this._instance.sendRequest(e,t)},p.prototype.sendPropBroadcast=function(e,t,n){this._instance.sendPropBroadcast(e,t,n)},p.prototype.sendBroadcast=function(e,t){this._instance.sendBroadcast(e,t)},p.prototype.createPropObservable=function(t){var n=this,r={};this.propBroadcastReceived.createSingleObservable(t),this.propNotifyReceived.createSingleObservable(t);var e=new u.ValueObservable(function(e){e.set(n.getProp(t)),r.accessor=e}),o=this.onPropChanging(t,function(e,t){var n=r.accessor.customizedSet(e.currentValue,t.message);e.observable&&(e.observable.onResolved(function(e){n.resolve(e)}),e.observable.onRejected(function(e){n.reject(e)}))});return e.pushDisposable(o),e},p.prototype.createObservable=function(){return new p(this)},p.prototype.copyModel=function(){var t=this,n={};return this.getKeys().forEach(function(e){n[e]=t.getProp(e)}),n},p.prototype.toJSON=function(){var e=this.copyModel();try{if(null!=e)return JSON.stringify(e)}catch(e){}return new String(e).toString()},p.prototype.dispose=function(){this._instance.dispose()},p);function p(e){var n=new u.DisposableArray;if(e instanceof p&&e._instance)return this._instance=__assign({},e._instance,{pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.pushDisposable.apply(n,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.removeDisposable.apply(n,e)},dispose:function(){n.dispose()}}),this.propChanging=e.propChanging.createObservable(),this.propChanged=e.propChanged.createObservable(),this.propChangeFailed=e.propChangeFailed.createObservable(),this.propBroadcastReceived=e.propBroadcastReceived.createObservable(),this.propNotifyReceived=e.propNotifyReceived.createObservable(),this.anyPropChanging=e.anyPropChanging.createObservable(),this.anyPropChanged=e.anyPropChanged.createObservable(),this.anyPropChangeFailed=e.anyPropChangeFailed.createObservable(),this.propsChanged=e.propsChanged.createObservable(),this.broadcastReceived=e.broadcastReceived.createObservable(),this.notifyReceived=e.notifyReceived.createObservable(),this.pushDisposable(this.propChanging,this.propChanged,this.propChangeFailed,this.propBroadcastReceived,this.propNotifyReceived,this.anyPropChanging,this.anyPropChanged,this.anyPropChangeFailed,this.propsChanged,this.broadcastReceived,this.notifyReceived),void e.pushDisposable(this);var r=u.Access.propsAccessor();this.propChanging=r.propChanging,this.propChanged=r.propChanged,this.propChangeFailed=r.propChangeFailed,this.propBroadcastReceived=r.propBroadcastReceived,this.propNotifyReceived=r.propNotifyReceived,this.anyPropChanging=r.anyPropChanging,this.anyPropChanged=r.anyPropChanged,this.anyPropChangeFailed=r.anyPropChangeFailed,this.propsChanged=r.propsChanged,this.broadcastReceived=r.broadcastReceived,this.notifyReceived=r.notifyReceived,n.pushDisposable(this.propChanging,this.propChanged,this.propChangeFailed,this.propBroadcastReceived,this.propNotifyReceived,this.anyPropChanging,this.anyPropChanged,this.anyPropChangeFailed,this.propsChanged,this.broadcastReceived,this.notifyReceived);var o={hasProp:function(e){return r.accessor.hasProp(e)},getProp:function(e){return r.accessor.getProp(e)},getPropKeys:function(){return r.accessor.getPropKeys()},setProp:function(e,t,n){return r.accessor.setProp(e,t,n)},removeProp:function(e,t){return r.accessor.removeProp(e,t)},batchProp:function(e,t){return r.accessor.batchProp(e,t)},forceUpdateProp:function(e){r.accessor.forceUpdateProp(e)}},i=function(e,t,n){r.sendPropRequest(e,t,n,function(n){return{get:function(){return r.accessor.getProp(n)},set:function(e,t){return r.accessor.setProp(n,e,t)},forceUpdate:function(){r.accessor.forceUpdateProp(n)}}}(e))},s=function(e,t){r.sendRequest(e,t,o)},a=function(e,t,n){r.sendPropBroadcast(e,t,n)},c=function(e,t){r.sendBroadcast(e,t)};if(this._instance={has:function(e){return r.accessor.hasProp(e)},get:function(e){return r.accessor.getProp(e)},keys:function(){return r.accessor.getPropKeys()},pushFlows:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return r.pushFlows.apply(r,[e].concat(t))},clearFlows:function(e){return r.clearFlows(e)},sendPropRequest:function(e,t,n){i(e,t,n)},sendRequest:function(e,t){s(e,t)},sendPropBroadcast:function(e,t,n){a(e,t,n)},sendBroadcast:function(e,t){c(e,t)},pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.pushDisposable.apply(n,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.removeDisposable.apply(n,e)},dispose:function(){n.dispose()}},"function"==typeof e){var t=e.additionalEvents;t&&(t.broadcastReceived instanceof u.SingleEventObservable&&(this.broadcastReceived=t.broadcastReceived,this.pushDisposable(this.broadcastReceived)),t.propBroadcastReceived instanceof u.EventObservable&&(this.propBroadcastReceived=t.propBroadcastReceived,this.pushDisposable(this.propBroadcastReceived)),t.notifyReceived instanceof u.SingleEventObservable&&(this.notifyReceived=t.notifyReceived,this.pushDisposable(this.notifyReceived)),t.propNotifyReceived instanceof u.EventObservable&&(this.propNotifyReceived=t.propNotifyReceived,this.pushDisposable(this.propNotifyReceived)),"function"==typeof t.sendRequest&&(s=t.sendRequest),"function"==typeof t.sendPropRequest&&(i=t.sendPropRequest),"function"==typeof t.sendBroadcast&&(c=t.sendBroadcast),"function"==typeof t.sendPropBroadcast&&(a=t.sendPropBroadcast)),e(r.accessor)}}u.PropsObservable=e;var f,n=(__extends(t,f=e),t.prototype.setProp=function(e,t,n){if("function"!=typeof this._propSetter)return!1;var r=this._propSetter(e,t,n);return!!r&&r.success},t.prototype.setPropForDetails=function(e,t,n){return"function"!=typeof this._propSetter?u.ChangedInfo.fail(null,void 0,t,"not implemented"):this._propSetter(e,t,n)},t.prototype.setPromiseProp=function(n,e,t,r){var o=this;return u.Access.setPromise(function(e,t){return o.setPropForDetails(n,e,t)},e,t,r)},t.prototype.setSubscribeProp=function(n,e,t,r,o){var i=this;return u.Access.setSubscribe(function(e,t){return i.setPropForDetails(n,e,t)},e,t,r,o)},t.prototype.sendPropNotify=function(e,t,n){"function"==typeof this._sendPropNotify&&this._sendPropNotify(e,t,n)},t.prototype.sendNotify=function(e,t){"function"==typeof this._sendNotify&&this._sendNotify(e,t)},t.prototype.registerPropRequestHandler=function(e,t,n){return"function"==typeof this._registerPropRequestHandler&&this._registerPropRequestHandler(e,t,n)},t.prototype.registerRequestHandler=function(e,t){return"function"==typeof this._registerRequestHandler&&this._registerRequestHandler(e,t)},t);function t(t,n,e,r,o,i,s,a){function c(e){e.batchProp(t),n(e.customizedSetProp)}var u=this;if(a&&(c.additionalEvents=a),u=f.call(this,c)||this,"function"==typeof e&&(u._propSetter=e),"function"==typeof r&&(u._sendPropNotify=r),"function"==typeof o&&(u._sendNotify=o),"function"==typeof i&&(u._registerPropRequestHandler=i),"function"==typeof s&&(u._registerRequestHandler=s),"undefined"!=typeof Proxy)return u.proxy=new Proxy({},{has:function(e,t){return!(!t||"string"!=typeof t)&&u.hasProp(t)},get:function(e,t,n){if(t&&"string"==typeof t)return u.getProp(t)},set:function(e,t,n,r){if(!t||"string"!=typeof t)throw new TypeError("the property key should be a string");return u.setProp(t,n)},ownKeys:function(e){return u.getKeys()},enumerate:function(e){return u.getKeys()}}),u}u.PropsClient=n;var r,o=(__extends(i,r=e),Object.defineProperty(i.prototype,"formatter",{get:function(){return this._accessor.getFormatter()},set:function(e){this._accessor.setFormatter(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"validator",{get:function(){return this._accessor.getValidator()},set:function(e){this._accessor.setValidator(e)},enumerable:!0,configurable:!0}),i.prototype.forceUpdateProp=function(e,t){this._accessor.forceUpdateProp(e,t)},i.prototype.setProp=function(e,t,n){var r=this._accessor.setProp(e,t,n);return!!r&&r.success},i.prototype.setPropForDetails=function(e,t,n){return this._accessor.setProp(e,t,n)},i.prototype.setPromiseProp=function(n,e,t,r){var o=this;return u.Access.setPromise(function(e,t){return o.setPropForDetails(n,e,t)},e,t,r)},i.prototype.setSubscribeProp=function(n,e,t,r,o){var i=this;return u.Access.setSubscribe(function(e,t){return i.setPropForDetails(n,e,t)},e,t,r,o)},i.prototype.removeProp=function(e,t){return this._accessor.removeProp(e,t)},i.prototype.setProps=function(e,t){return this._accessor.batchProp(e,t)},i.prototype.sendPropNotify=function(e,t,n){this._accessor.sendPropNotify(e,t,n)},i.prototype.sendNotify=function(e,t){this._accessor.sendNotify(e,t)},i.prototype.registerPropRequestHandler=function(e,t,n){return this._accessor.registerPropRequestHandler(e,t,n)},i.prototype.registerRequestHandler=function(e,t){return this._accessor.registerRequestHandler(e,t)},i.prototype.createPropClient=function(n){var e,o=this,t=new u.ValueClient(this.getProp(n),function(r){e=o.onPropChanging(n,function(e,t){var n=r(e.valueRequest,t.message);e.observable&&(e.observable.onResolved(function(e){n.resolve(e)}),e.observable.onRejected(function(e){n.reject(e)}))})},function(e,t){return o.setPropForDetails(n,e,t)},function(e,t){o._accessor.sendPropNotify(n,e,t)},function(e,t){return o._accessor.registerPropRequestHandler(n,e,t)},{broadcastReceived:this.propBroadcastReceived.createSingleObservable(n),notifyReceived:this.propNotifyReceived.createSingleObservable(n),sendRequest:function(e,t){o.sendPropRequest(n,e,t)},sendBroadcast:function(e,t){o.sendPropBroadcast(n,e,t)}});return t.pushDisposable(e),t},i.prototype.createClient=function(){var e,o=this,t=new n(this.copyModel(),function(r){e=o.onAnyPropChanging(function(e,t){var n=r(e.key,e.valueRequest,t.message);e.observable&&(e.observable.onResolved(function(e){n.resolve(e)}),e.observable.onRejected(function(e){n.reject(e)}))})},function(e,t,n){return o.setPropForDetails(e,t,n)},this._accessor.sendPropNotify,this._accessor.sendNotify,this.registerPropRequestHandler,this.registerRequestHandler,{propBroadcastReceived:this.propBroadcastReceived.createObservable(),broadcastReceived:this.broadcastReceived.createObservable(),propNotifyReceived:this.propNotifyReceived.createObservable(),notifyReceived:this.notifyReceived.createObservable(),sendPropRequest:function(e,t,n){o.sendPropRequest(e,t,n)},sendRequest:function(e,t){o.sendRequest(e,t)},sendPropBroadcast:function(e,t,n){o.sendPropBroadcast(e,t,n)},sendBroadcast:function(e,t){o.sendBroadcast(e,t)}});return t.pushDisposable(e),this.pushDisposable(t),t},i);function i(){var t,o=this;if((o=r.call(this,function(e){return t=e})||this)._accessor=t,"undefined"!=typeof Proxy)return o.proxy=new Proxy({},{has:function(e,t){return!(!t||"string"!=typeof t)&&o.hasProp(t)},get:function(e,t,n){if(t&&"string"==typeof t)return o.getProp(t)},set:function(e,t,n,r){if(!t||"string"!=typeof t)throw new TypeError("the property key should be a string");return o.setProp(t,n)},ownKeys:function(e){return o.getKeys()},enumerate:function(e){return o.getKeys()}}),o}u.PropsController=o}(DataSense||(DataSense={})),function(e){var t=(l.prototype.setOptions=function(e,t){t?e&&(this._options=__assign({},this._options,e)):this._options=e||{}},l.prototype.pushHandler=function(){for(var n=this,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=0;return e.forEach(function(e){var t;"function"==typeof e?r+=n._h.push(e):e instanceof Array&&(r+=(t=n._h).push.apply(t,e))}),r},l.prototype.clearHandler=function(){this._h=[]},l.prototype.process=function(e){this._proc(e)},l.prototype.abort=function(){this._abort()},l.delay=function(e,t){var n;return null==t||!1===t?e():!0===t?n=setTimeout(function(){n=null,e()},0):"number"==typeof t&&(n=setTimeout(function(){n=null,e()},t)),{dispose:function(){n&&clearTimeout(n),n=null}}},l.throttle=function(e,t,n){var r=new l;return r.setOptions({span:t,maxCount:1}),r.pushHandler(e),n||r.process(),r},l.debounce=function(e,t,n){var r=new l;return r.setOptions({delay:t,mergeMode:"debounce"}),r.pushHandler(e),n||r.process(),r},l.mono=function(e,t,n){var r=new l;return r.setOptions({delay:t,mergeMode:"mono"}),r.pushHandler(e),n||r.process(),r},l.multiHit=function(e,t,n,r,o){var i=new l;return i.setOptions({minCount:t,maxCount:n,span:r}),i.pushHandler(e),o||i.process(),i},l.schedule=function(t,r){function n(){a&&a.dispose(),a=null,s&&(clearInterval(s),s=null)}function o(e){u=new Date,t({startDate:c,latestStopDate:p,processDate:u,latestProcessDate:f,span:r,source:e}),f=new Date}function i(e,t){n(),a=l.delay(function(){a=null,o(t),s=setInterval(function(){o("schedule")},r)},e)}var s,a,c,u,p,f;return{start:function(e){var t=!1,n=e?"plan":"start";"number"==typeof e?t=e:!0===e&&(t=r),i(t,n)},process:function(){o("immediate")},resume:function(e){s||a||i(e,"resume")},pause:function(){n(),p=new Date},stop:function(){n(),p=new Date},get alive(){return s||a}}},l);function l(){var r=this;this._options={},this._h=[];function o(t){i=null;var n=s;s=new Date,u<Number.MAX_SAFE_INTEGER&&u++,r._h.forEach(function(e){e(t,{initDate:c,processDate:s,latestProcessDate:n,count:u,hitCount:p})})}var i,s,a,c=new Date,u=0,p=0;this._abort=function(){i&&clearTimeout(i),i=null},this._proc=function(e){var t=new Date;p++;var n=r._options;if(n.span&&a&&!(t.getTime()-a.getTime()>n.span)||(p=1),a=new Date,!(null!=n.minCount&&p<n.minCount||null!=n.maxCount&&p>n.maxCount)){if(i)if("debounce"===n.mergeMode)clearTimeout(i);else if("mono"===n.mergeMode)return;null==n.delay||!1===n.delay?o(e):!0===n.delay?i=setTimeout(function(){o(e)},0):"number"==typeof n.delay&&(i=setTimeout(function(){o(e)},n.delay))}}}e.HitTask=t}(DataSense||(DataSense={})),function(p){var r=(f.prototype.pushDisposable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._instance).pushDisposable.apply(e,t)},f.prototype.removeDisposable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._instance).removeDisposable.apply(e,t)},f.prototype.get=function(){return this._instance.get()},f.prototype.getType=function(){return typeof this._instance.get()},f.prototype.instanceOf=function(e){return this._instance.get()instanceof e},f.prototype.registerChangeFlow=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._instance).pushFlows.apply(e,t)},f.prototype.clearChangeFlow=function(){return this._instance.clearFlows()},f.prototype.onChanging=function(e,t,n,r){return this.changing.on(e,t,n,r)},f.prototype.onChanged=function(e,t,n,r){return this.changed.on(e,t,n,r)},f.prototype.onChangeFailed=function(e,t,n,r){return this.changeFailed.on(e,t,n,r)},f.prototype.onBroadcastReceived=function(e,t,n,r){return this.broadcastReceived.on(e,t,n,r)},f.prototype.onNotifyReceived=function(e,t,n,r){return this.notifyReceived.on(e,t,n,r)},f.prototype.subscribe=function(e,t){return this.changed.subscribeWithConvertor(e,t,function(e){return e.value})},f.prototype.sendRequest=function(e,t){this._instance.sendRequest(e,t)},f.prototype.sendBroadcast=function(e,t){this._instance.sendBroadcast(e,t)},f.prototype.createObservable=function(){return new f(this)},f.prototype.dispose=function(){this._instance.dispose()},f.prototype.toJSON=function(){var e=this._instance.get();try{if(null!=e)return JSON.stringify(e)}catch(e){}return new String(e).toString()},f);function f(e){var n,r,o=new p.DisposableArray,i="value";if(e instanceof f&&e._instance)return this._instance=__assign({},e._instance,{pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.pushDisposable.apply(o,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.removeDisposable.apply(o,e)},dispose:function(){o.dispose()}}),this.changing=e.changing.createObservable(),this.changed=e.changed.createObservable(),this.changeFailed=e.changeFailed.createObservable(),this.broadcastReceived=e.broadcastReceived.createObservable(),this.notifyReceived=e.notifyReceived.createObservable(),this.pushDisposable(this.changing,this.changed,this.changeFailed,this.broadcastReceived,this.notifyReceived),void e.pushDisposable(this);var s=p.Access.propsAccessor();s.accessor.setFormatter(function(e,t){return"function"!=typeof n||e!==i?t:n(t)}),s.accessor.setValidator(function(e,t){return"function"!=typeof r||e!==i||r(t)}),this.changing=s.propChanging.createSingleObservable(i),this.changed=s.propChanged.createSingleObservable(i),this.changeFailed=s.propChangeFailed.createSingleObservable(i),this.broadcastReceived=s.propBroadcastReceived.createSingleObservable(i),this.notifyReceived=s.propNotifyReceived.createSingleObservable(i),o.pushDisposable(this.changing,this.changed,this.changeFailed,this.broadcastReceived,this.notifyReceived);var a={get:function(){return s.accessor.getProp(i)},set:function(e,t){return s.accessor.setProp(i,e,t)},forceUpdate:function(e){s.accessor.forceUpdateProp(i,e)}},c=function(e,t){s.sendPropRequest(i,e,t,a)},u=function(e,t){s.sendPropBroadcast(i,e,t)};if(this._instance={get:function(){return s.accessor.getProp(i)},pushFlows:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.pushFlows.apply(s,[i].concat(e))},clearFlows:function(){return s.clearFlows(i)},sendRequest:function(e,t){c(e,t)},sendBroadcast:function(e,t){u(e,t)},pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.pushDisposable.apply(o,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.removeDisposable.apply(o,e)},dispose:function(){o.dispose()}},"function"==typeof e){var t=e.additionalEvents;t&&(t.broadcastReceived instanceof p.SingleEventObservable&&(this.broadcastReceived=t.broadcastReceived,this.pushDisposable(this.broadcastReceived)),t.notifyReceived instanceof p.SingleEventObservable&&(this.notifyReceived=t.notifyReceived,this.pushDisposable(this.notifyReceived)),"function"==typeof t.sendRequest&&(c=t.sendRequest),"function"==typeof t.sendBroadcast&&(u=t.sendBroadcast)),e({get:function(){return s.accessor.getProp(i)},set:function(e,t){return s.accessor.setProp(i,e,t)},customizedSet:function(e,t){return s.accessor.customizedSetProp(i,e,t)},forceUpdate:function(e){s.accessor.forceUpdateProp(i,e)},getFormatter:function(){return n},setFormatter:function(e){n=e},getValidator:function(){return r},setValidator:function(e){r=e},getStore:function(e){return s.accessor.getPropStore(i,e)},setStore:function(e,t){s.accessor.setPropStore(i,e,t)},removeStore:function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=s.accessor).removePropStore.apply(e,[i].concat(t))},sendNotify:function(e,t){s.accessor.sendPropNotify(i,e,t)},registerRequestHandler:function(e,t){return s.accessor.registerPropRequestHandler(i,e,t)}})}}p.ValueObservable=r;var c,o=(__extends(e,c=r),e.prototype.set=function(e,t){if("function"!=typeof this._setter)return!1;var n=this._setter(e,t);return!!n&&n.success},e.prototype.setForDetails=function(e,t){return"function"!=typeof this._setter?p.ChangedInfo.fail(null,void 0,e,"not implemented"):this._setter(e,t)},e.prototype.setPromise=function(e,t,n){var r=this;return p.Access.setPromise(function(e,t){return r.setForDetails(e,t)},e,t,n)},e.prototype.setSubscribe=function(e,t,n,r){var o=this;return p.Access.setSubscribe(function(e,t){return o.setForDetails(e,t)},e,t,n,r)},e.prototype.sendNotify=function(e,t){this._sendNotify(e,t)},e.prototype.registerRequestHandler=function(e,t){return"function"==typeof this._registerRequestHandler&&this._registerRequestHandler(e,t)},e);function e(t,n,e,r,o,i){function s(e){e.set(t),n(e.customizedSet)}var a=this;return i&&(s.additionalEvents=i),a=c.call(this,s)||this,"function"==typeof e&&(a._setter=e),"function"==typeof r&&(a._sendNotify=r),"function"==typeof o&&(a._registerRequestHandler=o),a}p.ValueClient=o;var n,t=(__extends(i,n=r),Object.defineProperty(i.prototype,"formatter",{get:function(){return this._accessor.getFormatter()},set:function(e){this._accessor.setFormatter(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"validator",{get:function(){return this._accessor.getValidator()},set:function(e){this._accessor.setValidator(e)},enumerable:!0,configurable:!0}),i.prototype.set=function(e,t){var n=this._accessor.set(e,t);return!!n&&n.success},i.prototype.setForDetails=function(e,t){return this._accessor.set(e,t)},i.prototype.setPromise=function(e,t,n){var r=this;return p.Access.setPromise(function(e,t){return r.setForDetails(e,t)},e,t,n)},i.prototype.setSubscribe=function(e,t,n,r){var o=this;return p.Access.setSubscribe(function(e,t){return o.setForDetails(e,t)},e,t,n,r)},i.prototype.registerRequestHandler=function(e,t){return this._accessor.registerRequestHandler(e,t)},i.prototype.observe=function(e,t,n){return e instanceof r?(this._observing=e.registerChangeFlow(this._accessor.customizedSet),t||this._accessor.customizedSet(e.get(),n).resolve(),this._observing):{sync:function(){},dispose:function(){}}},i.prototype.stopObserving=function(){var e=this._observing;e&&(delete this._observing,"function"==typeof e.dispose&&e.dispose())},i.prototype.syncFromObserved=function(e){var t=this._observing;return!(!t||"function"!=typeof t.sync||(t.sync(e),0))},i.prototype.isObserving=function(){return!!this._observing},i.prototype.createClient=function(){var e,n=this,t=new o(this.get(),function(r){e=n.onChanging(function(e,t){var n=r(e.valueRequest,t.message);e.observable&&(e.observable.onResolved(function(e){n.resolve(e)}),e.observable.onRejected(function(e){n.reject(e)}))})},function(e,t){return n.setForDetails(e,t)},this._accessor.sendNotify,this._accessor.registerRequestHandler,{broadcastReceived:this.broadcastReceived.createObservable(),notifyReceived:this.notifyReceived.createObservable(),sendRequest:function(e,t){n.sendRequest(e,t)},sendBroadcast:function(e,t){n.sendBroadcast(e,t)}});return t.pushDisposable(e),this.pushDisposable(t),t},i.prototype.sendNotify=function(e,t){this._accessor.sendNotify(e,t)},i);function i(){var t,e=this;return(e=n.call(this,function(e){return t=e})||this)._accessor=t,e}p.ValueController=t}(DataSense||(DataSense={}));